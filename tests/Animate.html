<!doctype html>
<html>
	<head>
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="viewport" content="width=device-width initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<!-- -->
		<title>Stack Layout</title>
		<!-- -->
		<script src="../../../enyo/enyo.js" type="text/javascript"></script>
		<!-- -->
		<link href="../Fitable/Fitable.css" rel="stylesheet" type="text/css" />
		<script src="../Fitable/Fitable.js" type="text/javascript"></script>
		<script src="../../aura/animator/Animation.js" type="text/javascript"></script>
		<!-- -->
		<style>
			body {
				Xoverflow: hidden;
			}
			.box {
				border: 3px solid red;
				padding: 8px;
			}

			.hi {
				height: 150px;
				background: orange;
				overflow: hidden;
			}

			.grn {
				border-color: lightgreen;
			}
			.blu {
				border-color: lightblue;
			}
			.mrg {
				margin: 4px 0px 10px 0px;
			}
		</style>
	</head>
	<body>
		<script>
			new enyo.Rows({classes: "enyo-fit enyo-unselectable", components: [
				{name: "drawer", style: "overflow: hidden;", components: [
					{name: "content", classes: "box grn hi", content: "000 Now is the time for all good men"}
				]},
				{classes: "box mrg grn", content: "111 Now is the time for all good men"},
				{fit: true, kind: "Rows", classes: "box blu", components: [
						{classes: "box", content: "000 Now is the time for all good men"},
						{classes: "box mrg", content: "111 Now is the time for all good men"},
						{fit: true, classes: "box", content: "FITTING 222 Now is the time for all good men"},
						{classes: "box", content: "333 Now is the time for all good men"}
				]},
				{classes: "box grn", content: "333 Now is the time for all good men"}
			],
			tap: function() {
				console.log("TAP!!");
				this.animate();
			},
			animate: function() {
				if (this.animation) {
					this.animation.stop();
					this.animation = null;
				}

				var s = this.hiding = !this.hiding;
				var g = this.$.drawer;
				var c = this.$.content;
				g.show();
				var h = c.hasNode().offsetHeight;
				this.animation = new enyo.Animation({
					duration: 600,
					startValue: s ? h : 0,
					endValue: s ? 0 : h,
					onStep: function(e) {
						g.applyStyle("height", e.value + "px");
						g.parent.parent.parent.resized();
					},
					onStop: function(e) {
						/*
						g.applyStyle("height", null);
						g.setShowing(!s);
						g.parent.parent.parent.resized();
						*/
					},
					onEnd: function() {
						if (s) {
							g.hide();
							g.parent.parent.parent.resized();
						}
					}
				}).play();
			}
			}).write();
		</script>
	</body>
</html>
